# 1. 프로세스 메모리 구조

코드를 작성해서 컴파일하고 프로그램을 실행시킬 때 어떠한 구조로 메모리에 할당될까요?
운영체제는 프로세스에 적절한 메모리를 할당하는데 다음 구조를 기반으로 할당합니다.

위에서부터 스택(stack), 힙(heap), 데이터 영역(BSS segment, Data segment), 코드 영역
(code segment)으로 나눠집니다.
스택은 위 주소부터 할당되고 힙은 아래 주소부터 할당됩니다

- `스택`
  - 지역변수, 매개변수, 함수가 저장되고 컴파일 시에 크기가 결정됨
  - 그러나 함수가 함수를 호출 하는 등에 따라 런타임시에도 크기가 변경됨
  - [동적인 특징]
- `힙`
  - 힙은 동적 할당할 때 사용되며 런타임 시 크기가 결정됨
  - [동적인 특징]
- `데이터영역`
  - BSS 영역과 Data 영역으로 나뉘고 정적할당에 관한 부분을 담당
  - [정적인 특징]
- `코드영역`
  - 소스코드 들어감. [정적인 특징]

p.62

---

# 1.1 정적할당

- 컴파일단계에서 메모리를 할당하는 것
- `BSS segment`와 `Data segment`, `code / text segment`로 3단계로 나뉘어서 저장됨
- `BSS segment`
  - 전역변수, static, const로 선언되어있는 변수 중 0으로 초기화
  - 또는 초기화가 어떠한 값으로도 되어 있지 않은 변수들이 이 메모리 영역에 할당됨
- `Data segment`
  - 전역변수, static, const로 선언되어있는 변수 중 0이 아닌 값으로 초기화된 변수가 이 메모리 영역에 할당됨
- `code / text segment`는 프로그램의 코드가 들어갑니다

---

# 1.2 동적할당

런타임단계에서 메모리를 할당받는 것이며 Stack과 Heap으로 나눠짐

- `Stack`
  - 지역변수, 매개변수, 실행되는 함수에 의해 **늘어나거나 줄어드는 메모리 영역**
  - 함수가 호출될 때마다 호출될 때의 환경 등 특정 정보가 stack에 계속해서 저장됨
  - 또한, 재귀함수가 호출된다고 했을 때 새로운 스택 프레임이 매번 사용되기 때문에 함수 내의 변수 집합이 해당 함수의 다른 인스턴스 변수를 방해하지 않습니다.
  - 즉, 재귀함수 내의 지역변수로 선언하게 되면 해당 변수는 독립적으로 작용하며 다른 함수에
있는 변수에 영향을 끼치지 않습니다.
- `Heap`
  - 동적으로 할당되는 변수들을 담습니다.
  - malloc(), free() 함수를 통해 관리할 수 있으며, 
  - 동적으로 관리되는 자료구조의 경우 Heap영역을 사용합니다. 
  - e.g. vector는 내부적으로 heap영역을 사용